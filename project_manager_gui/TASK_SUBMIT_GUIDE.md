# 任务提交功能 - 使用说明

---

## ✨ **新功能**

现在OpenClaw项目管理器新增了**任务提交界面**！

### 界面布局

程序现在有两个标签页：

```
╔════════════════════════════════╗
║  OpenClaw项目管理器            ║
╠════════════════════════════════╣
║ [项目管理] [任务提交] ← 标签页  ║
╠════════════════════════════════╣
║  任务提交（V2 Gateway）       ║
║  任务内容：                    ║
║  ┌──────────────────────────┐ ║
║  │ 输入你要执行的任务...     │ ║
║  │                          │ ║
║  └──────────────────────────┘ ║
║         [提交任务] [清空]     ║
║                                ║
║  就绪                          ║
║                                ║
║  任务结果：                    ║
║  ┌──────────────────────────┐ ║
║  │ 任务ID: xxx              │ ║
║  │ 状态: completed           │ ║
║  │ 模型: hunyuan-lite        │ ║
║  │ 耗时: 1.20秒             │ ║
║  │                          │ ║
║  │ 结果:                     │ ║
║  │ 这里显示AI的回答...       │ ║
║  └──────────────────────────┘ ║
╚════════════════════════════════╝
```

---

## 🎮 **使用流程**

### 步骤1: 启动程序

```bash
cd project_manager_gui
python main.py
```

### 步骤2: 启动V2 Gateway

1. 切换到"项目管理"标签
2. 找到 **V2 MVP** 项目
3. 点击 **Gateway** → **启动**
4. 等待"启动成功"日志

### 步骤3: 提交任务

1. 切换到"任务提交"标签
2. 在文本框输入任务内容，例如：
   - "介绍一下你自己"
   - "翻译这句话到英文：你好世界"
   - "帮我写一段Python代码"

3. 点击 **提交任务** 按钮

### 步骤4: 查看结果

- 程序会自动轮询任务状态
- 完成后显示：
  - 任务ID
  - 状态
  - 使用的模型
  - 耗时
  - AI回答结果

---

## 💡 **使用示例**

### 示例1: 简单问答

**输入：**
```
介绍一下你自己
```

**输出：**
```
任务ID: 32a1b2c3-4d5e-6f7g-8h9i-...
状态: completed
模型: hunyuan-lite
耗时: 1.20秒

结果:
我是腾讯混元大模型...
```

### 示例2: 翻译任务

**输入：**
```
翻译这句话到英文：你好世界
```

**输出：**
```
任务ID: 4d5e6f7g-8h9i-0j1k-2l3m-...
状态: completed
模型: hunyuan-lite
耗时: 0.89秒

结果:
Hello World
```

### 示例3: 代码生成

**输入：**
```
写一个Python函数，计算斐波那契数列的第n项
```

**输出：**
```
任务ID: 8h9i-0j1k-2l3m-4n5o-6p7q-...
状态: completed
模型: hunyuan-lite
耗时: 2.15秒

结果:
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)
```

---

## 🎯 **功能特点**

### 自动特性
- ✅ 自动提交任务到V2 Gateway
- ✅ 自动轮询任务状态（每秒1次）
- ✅ 自动显示结果
- ✅ 自动显示使用的模型
- ✅ 自动显示耗时

### 用户友好
- ✅ 清晰的标签页布局
- ✅ 实时状态提示
- ✅ 进度指示器
- ✅ 格式化结果输出

---

## ⚠️ **注意事项**

### 前置条件
1. 必须先启动 **V2 Gateway**
2. Gateway端口：8000
3. 地址：http://127.0.0.1:8000

### 错误处理
- **Gateway未运行** → 提示"无法连接到Gateway"
- **提交失败** → 提示错误原因
- **任务失败** → 显示错误信息

---

## 🔧 **技术说明**

### API调用
```python
# 提交任务
POST http://127.0.0.1:8000/tasks
Content-Type: application/json
Body: {"content": "任务内容"}

# 返回
{
  "task_id": "...",
  "status": "pending"
}

# 查询状态
GET http://127.0.0.1:8000/tasks/{task_id}

# 返回
{
  "task_id": "...",
  "status": "completed",
  "result": "...",
  "metadata": {
    "model": "hunyuan-lite",
    "latency": 1.20
  }
}
```

### 轮询机制
- 频率：每秒1次
- 超时：无（将持续直到完成）
- 自动停止：任务完成或失败后停止

---

## 🎉 **功能总结**

| 功能 | 状态 |
|------|------|
| 任务提交 | ✅ |
| 状态轮询 | ✅ |
| 结果显示 | ✅ |
| 错误处理 | ✅ |
| 进度提示 | ✅ |
| 多任务支持 | ⏳ (MVP只有1个) |

---

**更新时间：** 2026-02-16 05:10
**文件：** `gui/task_submit_widget.py`
**状态：** 🟢 可用
